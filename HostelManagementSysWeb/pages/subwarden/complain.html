<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sub Warden Dashboard</title>
  <!-- Include Bootstrap CSS (replace with local Bootstrap if needed) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>
    /* Add your custom styles for the dashboard here */
    .container {
      padding: 50px;
    }

    .card {
      margin-bottom: 20px;
    }
  </style>
</head>

<body>
<nav class="navbar navbar-expand-lg navbar-light bg-light justify-content-between p-3">
  <div>
    <a class="navbar-brand" href="/pages/subwarden/">Dashboard</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav ml-auto">
      <li class="nav-item active">
        <a class="nav-link active" href="./manageuser.html">Manage Users</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./registration.html">Registrations</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./complain.html">Complaints</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./visits.html">Visits</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./summaries.html">Summaries</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="./profile.html">Profile</a>
      </li>
    </ul>
  </div>
</nav>

<div class="container">
  <!-- Data will be dynamically loaded here -->
</div>

<!-- Include Bootstrap JS and jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  function loadMoreData() {
    $.ajax({
      method: "GET",
      url: "http://192.168.132.60:8080/complaint/getAll",
      success: function(data) {
        // Assuming data is an array of complaint objects
        data.forEach(complaint => {
          const card = `
              <div class="card">
                <div class="card-body">
                <div class="row">
                  <div class="col-md-9">
                    <h5 class="card-title">${complaint.complaint}</h5>
                    <p class="card-text">Complaint ID: ${complaint.compalint_id}</p>
                    <p class="card-text">Asset ID: ${complaint.asset_id}</p>
                    <p class="card-text">Student ID: ${complaint.student_id}</p>
                    <p class="card-text">Date and Time: ${complaint.date_and_time}</p>
                    <p class="card-text">Status: ${complaint.status}</p>
                   <button class="btn btn-primary" onclick="openNoteWindow(${complaint.compalint_id})">Resolve</button>
                  </div>
                  <div class="col-md-3">
                    <img src="data:image/jpeg;base64,${complaint.image}" alt="Complaint Image" class="img-fluid">
                   </div>
                  </div>
                 </div>

                 </div>
            `;
          $('.container').append(card);
        });
      },
      error: function(xhr, status, error) {
        console.log("Error:", error);
      }
    });
  }
  function openNoteWindow(compalint_id) {

    // URL of the note.html file
    const noteUrl = `note.html?complaint_id=${compalint_id}`
    // Width and height for the new window
    const width = 600;
    const height = 600;

    // Calculate the position to center the new window
    const left = (window.innerWidth - width) / 2;
    const top = (window.innerHeight - height) / 2;

    // Construct window features
    const features = `width=${width},height=${height},left=${left},top=${top}`;

    // Open the new window
    window.open(noteUrl, '_blank', features);
  }


  // Call the function to load the data
  loadMoreData();
</script>
</body>

</html>
